<%= render 'layouts/flash_messages' %>
<h5><%= @user.name %>の投稿一覧</h5>

<div class="container">
  <%= link_to '新規投稿', new_user_post_path(current_user), class: "btn btn-sm btn-primary" %>
  <ul class="category-box">
    <li class="category-item"><%= link_to "全て", user_posts_path(current_user), class: "btn btn-sm btn-outline-brand" %><li>
    <% @categories.each do |category| %>
      <li class="category-item">
        <%= link_to Category.find(category).name, user_posts_path(search: { category_id_eq: Category.find(category) }),
                                                  class: "btn btn-sm btn-outline-brand" %>
      </li>
    <% end %>
  </ul>
  <section>
    <% @user_posts.each do |user_post| %>
      <article class="wrap">
        <figure class="figure-box">
          <% if user_post.photo.attached? %>
            <%= image_tag user_post.photo.variant(resize:'300x300'), class: "figure-item" %>
          <% else %>
            <svg class="bd-placeholder-img" width="100%" height="100%" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" focusable="false" role="img" aria-label="Placeholder: Image">
              <title>Placeholder</title>
              <rect width="100%" height="100%" fill="#868e96"/>
              <text x="40%" y="50%" fill="#dee2e6" dy=".3em">No Image</text>
            </svg>
          <% end %>
          <!--
          <figcaption>
            <%= Golfclub.find(user_post.golfclub_id).name %>
          </figcaption>
          -->
        </figure>

        <div class="comment-box">
          <div class="comment-item">
            <span class="post-title"><%= user_post.title %></span><br/>
            <span><%= user_post.comment %></span>
          </div>
          <ul class="info-box">
            <li class="info-category"><%= Category.find(user_post.category_id).name %></li>
            <li class="info-edit"><%= link_to "", edit_user_post_path(@user_posts, user_post), class: "fas fa-edit" %></li>
            <li class="info-delete">
              <%= link_to "", user_post_path(@user_posts, user_post), 
                    class: "fas fa-trash-alt",
                    method: :delete,
                    remote: true,
                    data: { confirm: "タイトル: #{user_post.title} を削除してよろしいですか？",
                            cancel: 'キャンセル',
                            commit: '削除する'
                          }, title: '削除確認' %>
            </li>
            <li class="info-time">投稿日 : <%= user_post.created_at.strftime("%Y/%m/%d") %></li>
            <li class="info-user">投稿者 : <%= User.find(user_post.user_id).name %></li>
          </ul>
        </div>
      </article>
    <% end %>
  </section>
</div>
